<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover"/>
    <link rel="shortcut icon" href="<%= BASE_URL %>favicon.ico">
    <title><%= htmlWebpackPlugin.options.title %></title>
    <!-- 使用CDN加速的CSS 和 JS 文件 -->
    <% for(var css of htmlWebpackPlugin.options.cdn.css) { %>
    <link href="<%=css%>" rel="preload" as="style">
    <link rel="stylesheet" href="<%=css%>" as="style">
    <% } %>
    <% for(var js of htmlWebpackPlugin.options.cdn.js) { %>
    <link href="<%=js%>" rel="preload" as="script">
    <% } %>
    <style type="text/css">
      html,body,#app{height:100%;width:100%;padding:0;margin:0}
      html,body {overflow: hidden;}
      .launch{background-color:#f8f8f8;height:100%;display:flex;flex-direction:column}
      .launch__main{user-select:none;width:100%;flex-grow:1;display:flex;justify-content:center;align-items:center;flex-direction:column}
      .launch__footer{width:100%;flex-grow:0;text-align:center;padding:20px 0;font-size:14px;color:#666}
      .launch__footer>a{color:#666;text-decoration:none}
      .launch__loading{height:48px;width:48px;margin-bottom:20px}
      .launch__title{color:#333;font-size:16px;margin-bottom:10px}
      .launch__sub-title{color:#999;font-size:14px}
    </style>
    <script>
    ;(function (win, lib, maxWidth, designWidth) {
      var flexible = lib.flexible || (lib.flexible = {});
      var doc = win.document;
      var docEl = doc.documentElement;
      var remStyleEl = doc.createElement('style');
      var tid;
      // 基准像素
      var baseFontSize = 100;
      // 像素比
      var dpr = win.devicePixelRatio || 1;
      var rem = 50;

      function refreshRem() {
        var width = docEl.getBoundingClientRect().width;
        maxWidth = maxWidth || 540;
        width>maxWidth && (width=maxWidth);
        rem = width * baseFontSize / designWidth;
        remStyleEl.innerHTML = 'html{font-size:' + rem + 'px!important;}';
      }

      if (docEl.firstElementChild) {
        docEl.firstElementChild.appendChild(remStyleEl);
      } else {
        var wrap = doc.createElement('div');
        wrap.appendChild(remStyleEl);
        doc.write(wrap.innerHTML);
        wrap = null;
      }

      refreshRem();

      win.addEventListener('resize', function() {
        // 防止执行两次
        clearTimeout(tid);
        tid = setTimeout(refreshRem, 300);
      }, false);

      win.addEventListener('pageshow', function(e) {
        // 浏览器后退的时候重新计算
        if (e.persisted) {
          clearTimeout(tid);
          tid = setTimeout(refreshRem, 300);
        }
      }, false);

      if (doc.readyState === 'complete') {
        doc.body.style.fontSize = '16px';
      } else {
        doc.addEventListener('DOMContentLoaded', function(e) {
          doc.body.style.fontSize = '16px';
        }, false);
      }

      flexible.dpr = win.dpr = dpr;
      flexible.rem = win.rem = rem;
    })(window, window.lib || (window.lib = {}), 750, 750);
    </script>
  </head>
  <body>
    <noscript>
      <strong>你没有启用JavaScript. 此应用无法运行. 请开启JavaScript.</strong>
    </noscript>
    <div id="app">
      <div class="launch">
        <div class="launch__main">
          <img class="launch__loading" src="./svg/loading-circles.svg" alt="loading">
          <div class="launch__title">
            正在加载资源
          </div>
          <div class="launch__sub-title">
            请耐心等待...
          </div>
        </div>
        <div class="launch__footer">
           &copy;2020
        </div>
      </div>
    </div>
    <!-- 使用CDN加速的JS文件 -->
    <% for(var js of htmlWebpackPlugin.options.cdn.js) { %>
    <script src="<%=js%>"></script>
    <% } %>
    <!-- built files will be auto injected -->
  </body>
</html>
